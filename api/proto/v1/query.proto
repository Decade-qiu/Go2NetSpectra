syntax = "proto3";

package v1;

option go_package = "api/gen/v1";

import "google/protobuf/timestamp.proto";

// AggregationRequest defines the request for an aggregation query.
message AggregationRequest {
  google.protobuf.Timestamp start_time = 1;
  google.protobuf.Timestamp end_time = 2;
  string task_name = 3;
  // Optional filters
  string src_ip = 4;
  string dst_ip = 5;
  uint32 src_port = 6;
  uint32 dst_port = 7;
  uint32 protocol = 8;
}

// TaskSummary holds the aggregated metrics for a single task.
message TaskSummary {
  string task_name = 1;
  uint64 total_bytes = 2;
  uint64 total_packets = 3;
}

// QueryTotalCountsResponse contains a list of summaries for each task.
message QueryTotalCountsResponse {
  repeated TaskSummary summaries = 1;
}